const AWS = require('aws-sdk');

exports.handler = (event, context, callback) => {

  let html = `<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> <meta name="viewport" content="width=device-width"/> <link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet"/> <title></title> <style type="text/html"> @media only screen{html{min-height: 100%; background: #f3f3f3}}@media only screen and (max-width:596px){.small-float-center{margin: 0 auto !important; float: none !important; text-align: center !important}}@media only screen and (max-width:596px){table.body img{width: auto; height: auto}table.body center{min-width: 0 !important}table.body .container{width: 95% !important}table.body .columns{height: auto !important; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; padding-left: 16px !important; padding-right: 16px !important}table.body .columns .columns{padding-left: 0 !important; padding-right: 0 !important}table.body .collapse .columns{padding-left: 0 !important; padding-right: 0 !important}th.small-1{display: inline-block !important; width: 8.33333% !important}th.small-2{display: inline-block !important; width: 16.66667% !important}th.small-4{display: inline-block !important; width: 33.33333% !important}th.small-6{display: inline-block !important; width: 50% !important}th.small-8{display: inline-block !important; width: 66.66667% !important}th.small-10{display: inline-block !important; width: 83.33333% !important}th.small-12{display: inline-block !important; width: 100% !important}.columns th.small-12{display: block !important; width: 100% !important}table.menu{width: 100% !important}table.menu td, table.menu th{width: auto !important; display: inline-block !important}table.menu.vertical td, table.menu.vertical th{display: block !important}table.menu[align=center]{width: auto !important}}@media only screen and (max-width:596px){.logo-container{background-color: #f6f6f6}}</style></head><body style="-moz-box-sizing:border-box;-ms-text-size-adjust:100%;-webkit-box-sizing:border-box;-webkit-text-size-adjust:100%;Margin:0;background:#f3f3f3!important;box-sizing:border-box;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0;min-width:100%;padding:0;text-align:left;width:100%!important"> <span class="preheader" style="color:#f3f3f3;display:none!important;font-family:Lato,sans-serif;font-size:1px;font-stretch:normal;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1px;max-height:0;max-width:0;mso-hide:all!important;opacity:0;overflow:hidden;visibility:hidden"></span> <table class="body" style="Margin:0;background:#f3f3f3!important;border-collapse:collapse;border-spacing:0;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;height:100%;line-height:1.3;margin:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tr style="padding:0;text-align:left;vertical-align:top"> <td class="center" align="center" valign="top" style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;hyphens:auto;line-height:1.3;margin:0;padding:0;text-align:left;vertical-align:top;word-wrap:break-word"> <center style="min-width:580px;width:100%"> <table align="center" class="container float-center" style="Margin:0 auto;background:#fefefe;border-collapse:collapse;border-spacing:0;float:none;margin:0 auto;padding:0;text-align:center;vertical-align:top;width:580px"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <td style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;hyphens:auto;line-height:1.3;margin:0;padding:0;text-align:left;vertical-align:top;word-wrap:break-word"> <table class="spacer" style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <td height="50px" style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:50px;font-weight:400;hyphens:auto;line-height:50px;margin:0;mso-line-height-rule:exactly;padding:0;text-align:left;vertical-align:top;word-wrap:break-word">&#xA0;</td></tr></tbody> </table> <center style="min-width:580px;width:100%"> <img class="logo float-center" src="https://s3.amazonaws.com/ra-static-email/logo.png" alt="logo" align="center" style="-ms-interpolation-mode:bicubic;Margin:0 auto;clear:both;display:block;float:none;height:44px!important;margin:0 auto;max-width:100%;outline:0;text-align:center;text-decoration:none;width:136px!important"/> </center> <table class="spacer" style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <td height="20px" style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:20px;font-weight:400;hyphens:auto;line-height:20px;margin:0;mso-line-height-rule:exactly;padding:0;text-align:left;vertical-align:top;word-wrap:break-word">&#xA0;</td></tr></tbody> </table> <table class="row" style="border-collapse:collapse;border-spacing:0;display:table;padding:0;position:relative;text-align:left;vertical-align:top;width:100%"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <th class="small-12 large-12 columns first last" style="Margin:0 auto;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:0;padding-bottom:0;padding-left:16px;padding-right:16px;text-align:left;width:564px"> <table style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tr style="padding:0;text-align:left;vertical-align:top"> <th style="Margin:0;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0;padding:0;text-align:left"> <h1 class="text-center" style="Margin:0;Margin-bottom:0;color:#566069;font-family:Lato,sans-serif;font-size:24px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:normal;line-height:1.5;margin:0;margin-bottom:0;padding:0;text-align:center;word-wrap:normal">Forgot Your Password?</h1> <h2 class="text-center" style="Margin:0;Margin-bottom:0;color:#566069;font-family:Lato,sans-serif;font-size:20px;font-stretch:normal;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1.5;margin:0;margin-bottom:0;padding:0;text-align:center;word-wrap:normal">Thatâ€™s okay! Click on the button below to reset a new oneðŸ‘‡</h2> <table class="spacer" style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <td height="20px" style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:20px;font-weight:400;hyphens:auto;line-height:20px;margin:0;mso-line-height-rule:exactly;padding:0;text-align:left;vertical-align:top;word-wrap:break-word">&#xA0;</td></tr></tbody> </table> <center style="min-width:532px;width:100%"> <table class="button large float-center" style="Margin:0;border-collapse:collapse;border-spacing:0;float:none;margin:0;padding:0;text-align:center;vertical-align:top;width:auto"> <tr style="padding:0;text-align:left;vertical-align:top"> <td style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;hyphens:auto;line-height:1.3;margin:0;padding:0;text-align:left;vertical-align:top;word-wrap:break-word"> <table style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tr style="padding:0;text-align:left;vertical-align:top"> <td style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;background:#e1523d;border:none;border-collapse:collapse!important;color:#fefefe;font-family:Lato,sans-serif;font-size:16px;font-weight:400;hyphens:auto;line-height:1.3;margin:0;padding:0;text-align:left;vertical-align:top;word-wrap:break-word"><a href="https://stage.realty-next-develop.com/reset-password/?email=${encodeURIComponent(event.request.userAttributes.email)}&code=${event.request.codeParameter}" style="Margin:0;border:0 solid #e1523d;border-radius:3px;color:#fefefe;display:inline-block;font-family:Lato,sans-serif;font-size:14px;font-stretch:normal;font-style:normal;font-weight:400;letter-spacing:0;line-height:1.33;margin:0;padding:13px 20px 13px 20px;text-align:left;text-decoration:none">Reset Your Password</a></td></tr></table> </td></tr></table> </center> <table class="spacer" style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top;width:100%"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <td height="20px" style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:20px;font-weight:400;hyphens:auto;line-height:20px;margin:0;mso-line-height-rule:exactly;padding:0;text-align:left;vertical-align:top;word-wrap:break-word">&#xA0;</td></tr></tbody> </table> </th> <th class="expander" style="Margin:0;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0;padding:0!important;text-align:left;visibility:hidden;width:0"></th> </tr></table> </th> </tr></tbody> </table> <table class="row grey-background" style="background-color:#f6f6f6!important;border-collapse:collapse;border-spacing:0;display:table;padding:0;position:relative;text-align:left;vertical-align:top;width:100%"> <tbody> <tr style="padding:0;text-align:left;vertical-align:top"> <center style="min-width:580px;width:100%"> <table align="center" class="menu float-center" style="Margin:0 auto;border-collapse:collapse;border-spacing:0;float:none;margin:0 auto;padding:0;text-align:center;vertical-align:top;width:auto!important"> <tr style="padding:0;text-align:left;vertical-align:top"> <td style="-moz-hyphens:auto;-webkit-hyphens:auto;Margin:0;border-collapse:collapse!important;color:#0a0a0a;font-family:Lato,sans-serif;font-size:16px;font-weight:400;hyphens:auto;line-height:1.3;margin:0;padding:0;text-align:left;vertical-align:top;word-wrap:break-word"> <table style="border-collapse:collapse;border-spacing:0;padding:0;text-align:left;vertical-align:top"> <tr style="padding:0;text-align:left;vertical-align:top"> <th class="menu-item float-center" style="Margin:0 auto;color:#0a0a0a;float:none;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:15px;padding-right:10px;text-align:center"><a href="https://www.austinlocal.com/" style="Margin:0;color:#e1523d;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none"><img src="https://s3.amazonaws.com/ra-static-email/rss.png" alt="austinlocal" width="17px" height="17px" style="-ms-interpolation-mode:bicubic;border:none;clear:both;display:block;max-width:100%;outline:0;text-decoration:none;width:auto"/></a></th> <th class="menu-item float-center" style="Margin:0 auto;color:#0a0a0a;float:none;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:15px;padding-right:10px;text-align:center"><a href="https://www.facebook.com/realtyaustin" style="Margin:0;color:#e1523d;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none"><img src="https://s3.amazonaws.com/ra-static-email/facebook.png" alt="facebook" width="17px" height="17px" style="-ms-interpolation-mode:bicubic;border:none;clear:both;display:block;max-width:100%;outline:0;text-decoration:none;width:auto"/></a></th> <th class="menu-item float-center" style="Margin:0 auto;color:#0a0a0a;float:none;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:15px;padding-right:10px;text-align:center"><a href="https://twitter.com/realtyaustin" style="Margin:0;color:#e1523d;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none"><img src="https://s3.amazonaws.com/ra-static-email/twitter.png" alt="twitter" width="17px" height="17px" style="-ms-interpolation-mode:bicubic;border:none;clear:both;display:block;max-width:100%;outline:0;text-decoration:none;width:auto"/></a></th> <th class="menu-item float-center" style="Margin:0 auto;color:#0a0a0a;float:none;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:15px;padding-right:10px;text-align:center"><a href="https://www.linkedin.com/company/realty-austin" style="Margin:0;color:#e1523d;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none"><img src="https://s3.amazonaws.com/ra-static-email/linkedin.png" alt="linkedin" width="17px" height="17px" style="-ms-interpolation-mode:bicubic;border:none;clear:both;display:block;max-width:100%;outline:0;text-decoration:none;width:auto"/></a></th> <th class="menu-item float-center" style="Margin:0 auto;color:#0a0a0a;float:none;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:15px;padding-right:10px;text-align:center"><a href="https://www.youtube.com/user/realtyaustin" style="Margin:0;color:#e1523d;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none"><img src="https://s3.amazonaws.com/ra-static-email/youtube.png" alt="youtube" width="17px" height="17px" style="-ms-interpolation-mode:bicubic;border:none;clear:both;display:block;max-width:100%;outline:0;text-decoration:none;width:auto"/></a></th> <th class="menu-item float-center" style="Margin:0 auto;color:#0a0a0a;float:none;font-family:Lato,sans-serif;font-size:16px;font-weight:400;line-height:1.3;margin:0 auto;padding:15px;padding-right:10px;text-align:center"><a href="http://instagram.com/realtyaustin" style="Margin:0;color:#e1523d;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none"><img src="https://s3.amazonaws.com/ra-static-email/instagram.png" alt="instagram" width="17px" height="17px" style="-ms-interpolation-mode:bicubic;border:none;clear:both;display:block;max-width:100%;outline:0;text-decoration:none;width:auto"></a></th> </tr></table> </td></tr></table> </center> <p class="text-center" style="Margin:0;Margin-bottom:0;color:#7f8e9b;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1.3;margin:0;margin-bottom:0;padding:0;text-align:center">Copyright 2018 Realty Austin, LLC. All Rights Reserved.<br>Realty Austin is an Equal Opportunity Employer and supports the Fair Housing Act.<br><a href="https://www.realtyaustin.com/privacy-policy.php" style="Margin:0;color:#299cbd;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none">Privacy Policy</a> | <a href="https://www.realtyaustin.com/terms-of-use.php" style="Margin:0;color:#299cbd;font-family:Lato,sans-serif;font-size:12px;font-stretch:normal;font-style:normal;font-weight:700;letter-spacing:0;line-height:1.33;margin:0;padding:0;text-align:left;text-decoration:none">Terms of Use</a></p></tr></tbody> </table> </td></tr></tbody> </table> </center> </td></tr></table> <div style="display:none;white-space:nowrap;font:15px courier;line-height:0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </div></body></html>`;

  if (event.triggerSource === "CustomMessage_ForgotPassword") {
    event.response.emailMessage = html;
  }


  callback(null, event);
};